{"version":3,"file":"router.js","sources":["packages/utils/router.ts"],"sourcesContent":["import type { RouterOptions } from '@/packages/types'\r\n\r\n/**\r\n * 导航到指定 URL\r\n *\r\n * @param url 目标URL\r\n *\r\n * @example\r\n * // 跳转到首页\r\n * Push('/pages/home/index')\r\n *\r\n * // 带参数的跳转\r\n * Push('/pages/detail?id=123')\r\n */\r\nexport function Push(url : string) : void {\r\n  if (!url) return\r\n\r\n  // #ifdef H5\r\n  try {\r\n    window.location.href = url\r\n  } catch (e) {\r\n    console.error('Push navigation failed:', e)\r\n  }\r\n  // #endif\r\n\r\n  // #ifndef H5\r\n  uni.navigateTo({ url })\r\n  // #endif\r\n}\r\n\r\n/**\r\n * 重定向到指定 URL（替换当前页面）\r\n *\r\n * @param url 目标URL\r\n *\r\n * @example\r\n * // 登录后重定向到首页\r\n * Replace('/pages/home')\r\n *\r\n * // 替换当前页面为详情页\r\n * Replace('/pages/detail?id=456')\r\n */\r\nexport function Replace(url : string) : void {\r\n  if (!url) return\r\n\r\n  // #ifdef H5\r\n  try {\r\n    window.location.replace(url)\r\n  } catch (e) {\r\n    console.error('Replace navigation failed:', e)\r\n  }\r\n  // #endif\r\n\r\n  // #ifndef H5\r\n  uni.redirectTo({ url })\r\n  // #endif\r\n}\r\n\r\n/**\r\n * 重启应用并跳转到指定 URL\r\n *\r\n * @param url 目标URL\r\n *\r\n * @example\r\n * // 登录过期后重启到登录页\r\n * Relaunch('/pages/login')\r\n *\r\n * // 切换用户身份后重启应用\r\n * Relaunch('/pages/home?role=admin')\r\n */\r\nexport function Relaunch(url : string) : void {\r\n  if (!url) return\r\n\r\n  // #ifdef H5\r\n  try {\r\n    const newWindow = window.open(url, '_blank')\r\n    if (newWindow) {\r\n      newWindow.opener = null\r\n      window.close()\r\n    } else {\r\n      window.location.href = url\r\n    }\r\n  } catch (e) {\r\n    console.error('Relaunch navigation failed:', e)\r\n    window.location.href = url\r\n  }\r\n  // #endif\r\n\r\n  // #ifndef H5\r\n  uni.reLaunch({ url })\r\n  // #endif\r\n}\r\n\r\n/**\r\n * 返回上一页或多页\r\n *\r\n * @param delta 返回的页面数，默认为1\r\n *\r\n * @example\r\n * // 返回上一页\r\n * Back()\r\n *\r\n * // 返回前两页\r\n * Back(2)\r\n *\r\n * // 从字符串参数返回\r\n * Back('1')\r\n */\r\nexport function Back(delta : number | string = 1) : void {\r\n  let deltaNum = Number(delta)\r\n\r\n  if (isNaN(deltaNum)) {\r\n    deltaNum = 1\r\n  } else if (deltaNum <= 0) {\r\n    deltaNum = 1\r\n  }\r\n\r\n  // #ifdef H5\r\n  try {\r\n    window.history.go(-deltaNum)\r\n  } catch (e) {\r\n    console.error('Back navigation failed:', e)\r\n  }\r\n  // #endif\r\n\r\n  // #ifndef H5\r\n  uni.navigateBack({ delta: deltaNum })\r\n  // #endif\r\n}\r\n\r\n/**\r\n * 统一路由方法\r\n *\r\n * @param router 路由配置\r\n *\r\n * @example\r\n * // 字符串形式跳转\r\n * Router('/pages/home')\r\n *\r\n * // 对象形式跳转 - 切换tab页\r\n * Router({ tab: 1, url: '/pages/home' })\r\n *\r\n * // 对象形式跳转 - 普通跳转\r\n * Router({ tab: 2, url: '/pages/detail' })\r\n *\r\n * // 对象形式跳转 - 返回\r\n * Router({ tab: 3, url: '1' }) // 返回1页\r\n *\r\n * // 函数形式执行\r\n * Router(() => {\r\n *   console.log('执行自定义路由逻辑')\r\n *   // 可以在这里添加自定义跳转逻辑\r\n * })\r\n */\r\nexport function Router(router : RouterOptions) : void | Promise<any> {\r\n  if (!router) return\r\n\r\n  if (typeof router === 'object') {\r\n    const { tab = 2, url = '' } = router\r\n    if (!url) return\r\n\r\n    switch (tab) {\r\n      case 1: return uni.switchTab({ url })\r\n      case 2: return Push(url)\r\n      case 3: return Back(url)\r\n      case 4: return Relaunch(url)\r\n      case 5: return Replace(url)\r\n      default: return Push(url)\r\n    }\r\n  } else if (typeof router === 'function') {\r\n    try {\r\n      return router()\r\n    } catch (e) {\r\n      console.error('Router function execution failed:', e)\r\n    }\r\n  } else if (typeof router === 'string' && router.trim()) {\r\n    Push(router)\r\n  }\r\n}\n"],"names":["Push","url","uni","navigateTo","router","tab","switchTab","delta","deltaNum","Number","isNaN","navigateBack","Back","reLaunch","Relaunch","redirectTo","Replace","e","index","__f__","trim"],"mappings":"uDAcO,SAASA,EAAKC,GACdA,GAWDC,EAAAA,MAAAC,WAAW,CAAEF,OAEnB,gBA8HO,SAAgBG,GACrB,GAAKA,EAED,GAAkB,iBAAXA,EAAqB,CAC9B,MAAMC,IAAEA,EAAM,EAAGJ,IAAAA,EAAM,IAAOG,EAC9B,IAAKH,EAAK,OAEV,OAAQI,GACN,KAAK,EAAG,OAAOH,QAAII,UAAU,CAAEL,QAC/B,KAAK,EAIL,QAAS,OAAOD,EAAKC,GAHrB,KAAK,EAAG,OAxDE,SAAKM,EAA0B,GACzC,IAAAC,EAAWC,OAAOF,IAElBG,MAAMF,IAECA,GAAY,KADVA,EAAA,GAcbN,EAAAA,MAAIS,aAAa,CAAEJ,MAAOC,GAE5B,CAoCqBI,CAAKX,GACpB,KAAK,EAAG,OA/FP,SAAkBA,GAClBA,GAkBDC,EAAAA,MAAAW,SAAS,CAAEZ,OAEjB,CA0EqBa,CAASb,GACxB,KAAK,EAAG,OA5HP,SAAiBA,GACjBA,GAWDC,EAAAA,MAAAa,WAAW,CAAEd,OAEnB,CA8GqBe,CAAQf,GAEzB,MAAA,GAC2B,mBAAXG,EACZ,IACF,OAAOA,UACAa,GACPf,EAAAgB,MAAcC,MAAA,QAAA,kCAAA,oCAAqCF,EACrD,KAC2B,iBAAXb,GAAuBA,EAAOgB,QAC9CpB,EAAKI,EAET"}