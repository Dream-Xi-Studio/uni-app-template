{"version":3,"file":"modal.js","sources":["utils/tips/modal.ts"],"sourcesContent":["import { ModalOptions } from '@/types/index'\r\n\r\n/**\r\n * 显示一个模态对话框（Modal），适用于 `uni.showModal`\r\n *\r\n * - 在小程序 (`MP`) 环境下，`confirmText` 和 `cancelText` 仅保留前 4 个字符\r\n * - 在 Android App (`APP-ANDROID`) 环境下，交换 `confirmText` 和 `cancelText` 及其颜色，以适应系统 UI 习惯\r\n *\r\n * @param {ModalOptions} [opt] 模态框选项，可包含 `title`、`content`、`confirmText`、`cancelText` 等\r\n * @returns {Promise<boolean>} 通过 Promise 返回 `true`（用户点击确认）或 `false`（用户点击取消）\r\n *\r\n * @example\r\n * // 基本使用：默认确认/取消按钮\r\n * Modal({ content: '确定要执行此操作吗？' })\r\n *   .then(confirmed => {\r\n *     if (confirmed) {\r\n *       console.log('用户点击了确认')\r\n *     } else {\r\n *       console.log('用户点击了取消')\r\n *     }\r\n *   })\r\n *\r\n * @example\r\n * // 自定义按钮文本\r\n * Modal({\r\n *   title: '警告',\r\n *   content: '此操作不可撤销！',\r\n *   confirmText: '继续',\r\n *   cancelText: '放弃'\r\n * }).then(confirmed => {\r\n *   if (confirmed) {\r\n *     console.log('用户选择继续')\r\n *   } else {\r\n *     console.log('用户选择放弃')\r\n *   }\r\n * })\r\n *\r\n * @example\r\n * // 处理成功/失败回调\r\n * Modal({\r\n *   title: '提示',\r\n *   content: '是否启用新功能？',\r\n *   success: (res) => console.log('Modal 显示成功:', res),\r\n *   fail: (err) => console.log('Modal 显示失败:', err),\r\n *   confirm: () => console.log('用户确认操作'),\r\n *   cancel: () => console.log('用户取消操作')\r\n * })\r\n */\r\nexport const Modal = (opt ?: ModalOptions) : Promise<boolean> => {\r\n  const { success, fail, confirm, cancel, ...options } = opt || {}\r\n\r\n  const modalOptions : UniApp.ShowModalOptions = {\r\n    title: '温馨提示',\r\n    showCancel: true,\r\n    cancelText: '取消',\r\n    cancelColor: '#666666',\r\n    confirmText: '确定',\r\n    confirmColor: '#0072FF',\r\n    ...options\r\n  }\r\n\r\n  // #ifdef MP\r\n  modalOptions.cancelText = modalOptions.cancelText?.slice(0, 4)\r\n  modalOptions.confirmText = modalOptions.confirmText?.slice(0, 4)\r\n    // #endif\r\n\r\n    // #ifdef APP-ANDROID\r\n    ;[modalOptions.confirmText, modalOptions.cancelText] = [modalOptions.cancelText, modalOptions.confirmText]\r\n    ;[modalOptions.confirmColor, modalOptions.cancelColor] = [modalOptions.cancelColor, modalOptions.confirmColor]\r\n  // #endif\r\n\r\n  return new Promise((resolve, reject) => {\r\n    uni.showModal({\r\n      ...modalOptions,\r\n      success: (res : UniApp.ShowModalRes) => {\r\n        success?.(res)\r\n        if (res.confirm) {\r\n          confirm?.()\r\n          resolve(true)\r\n        } else {\r\n          cancel?.()\r\n          resolve(false)\r\n        }\r\n      },\r\n      fail: (err : any) => {\r\n        fail?.(err)\r\n        reject(err)\r\n      }\r\n    })\r\n  })\r\n}\n"],"names":["uni"],"mappings":";;AAgDa,MAAA,QAAQ,CAAC,QAA2C;;AACzD,QAAA,EAAE,SAAS,MAAM,SAAS,QAAQ,GAAG,QAAA,IAAY,OAAO;AAE9D,QAAM,eAAyC;AAAA,IAC7C,OAAO;AAAA,IACP,YAAY;AAAA,IACZ,YAAY;AAAA,IACZ,aAAa;AAAA,IACb,aAAa;AAAA,IACb,cAAc;AAAA,IACd,GAAG;AAAA,EAAA;AAIL,eAAa,cAAa,kBAAa,eAAb,mBAAyB,MAAM,GAAG;AAC5D,eAAa,eAAc,kBAAa,gBAAb,mBAA0B,MAAM,GAAG;AAQ9D,SAAO,IAAI,QAAQ,CAAC,SAAS,WAAW;AACtCA,kBAAAA,MAAI,UAAU;AAAA,MACZ,GAAG;AAAA,MACH,SAAS,CAAC,QAA8B;AACtC,2CAAU;AACV,YAAI,IAAI,SAAS;AACL;AACV,kBAAQ,IAAI;AAAA,QAAA,OACP;AACI;AACT,kBAAQ,KAAK;AAAA,QACf;AAAA,MACF;AAAA,MACA,MAAM,CAAC,QAAc;AACnB,qCAAO;AACP,eAAO,GAAG;AAAA,MACZ;AAAA,IAAA,CACD;AAAA,EAAA,CACF;AACH;;"}